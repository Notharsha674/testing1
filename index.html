<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuk's Orange Quest!</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <style>
        :root { --orange: #FF8C00; --pink: #FF1493; --purple: #8A2BE2; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Comic Sans MS', cursive, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            height: 100vh; overflow: hidden; display: flex;
            justify-content: center; align-items: center; position: relative;
            touch-action: none;
        }

        .container {
            text-align: center; z-index: 10; padding: 1.5rem;
            width: 90%; max-width: 400px; height: 80vh;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 40px; backdrop-filter: blur(20px);
            box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
            border: 3px solid white;
            display: none; flex-direction: column; align-items: center; justify-content: space-between;
        }

        .active-page { display: flex; animation: slideUp 0.5s ease-out; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        h1 { font-size: 1.6rem; color: var(--pink); text-shadow: 0 2px 5px white; }
        .subtitle { color: var(--purple); font-weight: bold; font-size: 0.9rem; margin-bottom: 10px; }

        .btn {
            padding: 1rem 2rem; font-size: 1.2rem; font-weight: bold;
            background: linear-gradient(45deg, var(--pink), var(--purple));
            color: white; border: none; border-radius: 50px;
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.4);
            cursor: pointer; width: 90%;
        }

        .game-box { 
            position: relative; width: 100%; height: 300px; 
            background: rgba(255,255,255,0.2); border-radius: 25px; 
            overflow: hidden;
        }

        /* Catch Game Styles */
        #catcher { position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); font-size: 3rem; touch-action: none; z-index: 15; }
        .falling-orange { position: absolute; font-size: 2rem; z-index: 10; }

        /* Other Game Styles */
        #glass { width: 70px; height: 100px; border: 4px solid white; border-top: none; border-radius: 0 0 20px 20px; position: relative; overflow: hidden; }
        #juice { position: absolute; bottom: 0; width: 100%; height: 0%; background: orange; }
        .maze-wall { position: absolute; background: var(--purple); border-radius: 10px; }
        #maze-player { position: absolute; font-size: 2rem; z-index: 20; }
        .letter-tile { width: 60px; height: 60px; background: white; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; color: var(--pink); box-shadow: 0 4px 10px rgba(0,0,0,0.1); touch-action: none; }

        #mascot-container { position: fixed; bottom: 10px; left: 10px; z-index: 1000; display: none; }
        #mascot { width: 60px; border-radius: 12px; border: 2px solid white; }
        #speech { position: absolute; bottom: 70px; left: 0; background: white; padding: 10px; border-radius: 15px; font-size: 0.7rem; width: 140px; display: none; border: 2px solid var(--pink); }
    </style>
</head>
<body>

    <audio id="bg-music" loop src="Yellow.mp3"></audio>

    <div id="p1" class="container active-page">
        <div><h1>Happy Birthday, Kuk! üéÇ</h1><p class="subtitle">Ready for your quest?</p></div>
        <img src="https://img.icons8.com/bubbles/200/birthday-cake.png" width="150">
        <button class="btn" onclick="nextPage(2)">START üçä</button>
    </div>

    <div id="p2" class="container">
        <h1>Step 1: The Juice</h1>
        <p class="subtitle">HOLD the orange to fill the glass!</p>
        <div class="game-box" style="display:flex; align-items:center; justify-content:center;">
            <div id="glass"><div id="juice"></div></div>
            <div id="orange-btn" style="font-size: 4rem; margin-left: 20px;" ontouchstart="startSqueeze()" ontouchend="stopSqueeze()">üçä</div>
        </div>
        <p id="juice-status">0% Full</p>
    </div>

    <div id="p3" class="container">
        <h1>Step 2: Orange Catch</h1>
        <p id="catch-count" class="subtitle">Catch 10 oranges! (0/10)</p>
        <div class="game-box" id="catch-area">
            <div id="catcher">ü¶ñ</div>
        </div>
    </div>

    <div id="p4" class="container">
        <h1>Step 3: The Maze</h1>
        <p class="subtitle">Drag the heart to the Dino!</p>
        <div class="game-box" id="maze-container">
            <div class="maze-wall" style="width: 80%; height: 10px; top: 70px; left: 0;"></div>
            <div class="maze-wall" style="width: 80%; height: 10px; bottom: 90px; right: 0;"></div>
            <div id="maze-target" style="position:absolute; bottom:10px; right:10px; font-size:2rem;">ü¶ñ</div>
            <div id="maze-player">‚ù§Ô∏è</div>
        </div>
    </div>

    <div id="p5" class="container">
        <h1>Step 4: Pop Time!</h1>
        <p class="subtitle">Pop the orange bubbles!</p>
        <div id="bubble-box" class="game-box" style="display:grid; grid-template-columns: repeat(4,1fr); gap:10px; padding:15px;"></div>
    </div>

    <div id="p6" class="container">
        <h1>Step 5: Your Name</h1>
        <p class="subtitle">Drag letters to the boxes!</p>
        <div class="game-box" style="display:flex; flex-direction:column; justify-content:center; gap:20px;">
            <div style="display:flex; gap:10px;" id="drop-zone">
                <div class="letter-tile" style="border:2px dashed #ccc; background:none;"></div>
                <div class="letter-tile" style="border:2px dashed #ccc; background:none;"></div>
                <div class="letter-tile" style="border:2px dashed #ccc; background:none;"></div>
            </div>
            <div style="display:flex; gap:10px;">
                <div class="letter-tile draggable-l">K</div>
                <div class="letter-tile draggable-l">U</div>
                <div class="letter-tile draggable-l">K</div>
            </div>
        </div>
    </div>

    <div id="p7" class="container">
        <h1>Happy Birthday Kuk! üå∏</h1>
        <p style="padding:10px; font-size:0.9rem;">You did it! You caught the oranges, cleared the maze, and proved you're the best. Have the most amazing day ever! üß°</p>
        <button class="btn" onclick="location.reload()">REPLAY ü¶ñ</button>
    </div>

    <div id="mascot-container">
        <div id="speech"></div>
        <img id="mascot" src="dino.jpg">
    </div>

    <script>
        let score = 0;
        let juiceLevel = 0;
        let squeezeInterval;
        let caught = 0;
        let catchInterval;

        function nextPage(n) {
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active-page'));
            document.getElementById('p'+n).classList.add('active-page');
            if(n===2) { 
                document.getElementById('mascot-container').style.display = 'block';
                document.getElementById('bg-music').play();
            }
            if(n===3) startCatchGame();
            if(n===4) initMaze();
            if(n===5) initBubbles();
            if(n===6) initScramble();
        }

        function showMascot(text) {
            const s = document.getElementById('speech');
            s.innerText = text; s.style.display = 'block';
            setTimeout(() => s.style.display = 'none', 3000);
        }

        // STEP 1 Logic
        function startSqueeze() {
            squeezeInterval = setInterval(() => {
                if(juiceLevel < 100) {
                    juiceLevel += 3;
                    document.getElementById('juice').style.height = juiceLevel + '%';
                    document.getElementById('juice-status').innerText = juiceLevel + '% Full';
                } else {
                    stopSqueeze(); nextPage(3);
                }
            }, 50);
        }
        function stopSqueeze() { clearInterval(squeezeInterval); }

        // STEP 2 Logic (NEW CATCH GAME)
        function startCatchGame() {
            showMascot("Catch 10 oranges!");
            const catcher = document.getElementById('catcher');
            const area = document.getElementById('catch-area');
            
            // Make Dino draggable left/right
            Draggable.create(catcher, {
                type: "x", bounds: area,
            });

            catchInterval = setInterval(() => {
                if(caught >= 10) {
                    clearInterval(catchInterval);
                    nextPage(4);
                    return;
                }
                createOrange();
            }, 1000);
        }

        function createOrange() {
            const area = document.getElementById('catch-area');
            const orange = document.createElement('div');
            orange.className = 'falling-orange';
            orange.innerText = 'üçä';
            orange.style.left = Math.random() * (area.offsetWidth - 30) + 'px';
            orange.style.top = '-40px';
            area.appendChild(orange);

            gsap.to(orange, {
                y: 350, duration: 2.5, ease: "none",
                onUpdate: function() {
                    const cRect = document.getElementById('catcher').getBoundingClientRect();
                    const oRect = orange.getBoundingClientRect();
                    if(!(oRect.right < cRect.left || oRect.left > cRect.right || oRect.bottom < cRect.top || oRect.top > cRect.bottom)) {
                        caught++;
                        document.getElementById('catch-count').innerText = `Catch 10 oranges! (${caught}/10)`;
                        orange.remove();
                        this.kill();
                    }
                },
                onComplete: () => orange.remove()
            });
        }

        // STEP 3 Maze
        function initMaze() {
            Draggable.create("#maze-player", {
                type: "x,y", bounds: "#maze-container",
                onDrag: function() {
                    if(this.hitTest("#maze-target", "50%")) { this.disable(); nextPage(5); }
                }
            });
        }

        // STEP 4 Bubbles
        function initBubbles() {
            const box = document.getElementById('bubble-box');
            let popped = 0;
            for(let i=0; i<12; i++) {
                const b = document.createElement('div');
                b.style.background = 'orange'; b.style.borderRadius = '50%';
                b.onclick = function() {
                    this.style.visibility = 'hidden'; popped++;
                    if(popped === 12) nextPage(6);
                };
                box.appendChild(b);
            }
        }

        // STEP 5 Scramble
        function initScramble() {
            Draggable.create(".draggable-l", {
                bounds: "body",
                onRelease: function() {
                    if(this.y < -100) {
                        this.target.style.opacity = '0.5';
                        if(document.querySelectorAll('.draggable-l[style*="opacity: 0.5"]').length === 3) nextPage(7);
                    }
                }
            });
        }
    </script>
</body>
</html>
