<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Kuk's Orange Quest!</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/Draggable.min.js"></script>
    <style>
        :root { --orange: #FF8C00; --pink: #FF1493; --purple: #8A2BE2; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Comic Sans MS', cursive, sans-serif; -webkit-tap-highlight-color: transparent; }
        
        body {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
            height: 100vh; overflow: hidden; display: flex;
            justify-content: center; align-items: center; position: relative;
            touch-action: none; /* Prevents accidental scrolling during games */
        }

        .container {
            text-align: center; z-index: 10; padding: 1.5rem;
            width: 90%; max-width: 400px; height: 80vh;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 40px; backdrop-filter: blur(20px);
            box-shadow: 0 15px 35px rgba(255, 105, 180, 0.3);
            border: 3px solid white;
            display: none; flex-direction: column; align-items: center; justify-content: space-between;
        }

        .active-page { display: flex; animation: slideUp 0.5s ease-out; }
        @keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        h1 { font-size: 1.6rem; color: var(--pink); text-shadow: 0 2px 5px white; }
        .subtitle { color: var(--purple); font-weight: bold; font-size: 0.9rem; margin-bottom: 10px; }

        .btn {
            padding: 1rem 2rem; font-size: 1.2rem; font-weight: bold;
            background: linear-gradient(45deg, var(--pink), var(--purple));
            color: white; border: none; border-radius: 50px;
            box-shadow: 0 5px 15px rgba(255, 20, 147, 0.4);
            cursor: pointer; width: 90%;
        }

        /* --- GAME CANVAS STYLES --- */
        .game-box { 
            position: relative; width: 100%; height: 280px; 
            background: rgba(255,255,255,0.3); border-radius: 25px; 
            overflow: hidden; display: flex; align-items: center; justify-content: center;
        }

        /* Squeeze Game */
        #glass { width: 80px; height: 120px; border: 4px solid white; border-top: none; border-radius: 0 0 20px 20px; position: relative; overflow: hidden; }
        #juice { position: absolute; bottom: 0; width: 100%; height: 0%; background: orange; transition: 0.1s; }

        /* Maze Game */
        .maze-wall { position: absolute; background: var(--purple); border-radius: 10px; }
        #maze-target { position: absolute; bottom: 10px; right: 10px; font-size: 2rem; }
        #maze-player { width: 40px; height: 40px; position: absolute; top: 10px; left: 10px; z-index: 20; touch-action: none; }

        /* Dark Search */
        #dark-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #222; z-index: 5; }
        #flashlight { 
            position: absolute; width: 120px; height: 120px; 
            background: radial-gradient(circle, rgba(255,255,255,1) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%; pointer-events: none; z-index: 6; mix-blend-mode: screen; 
        }

        #mascot-container { position: fixed; bottom: 10px; left: 10px; z-index: 1000; display: none; }
        #mascot { width: 60px; border-radius: 12px; border: 2px solid white; }
        #speech { position: absolute; bottom: 70px; left: 0; background: white; padding: 10px; border-radius: 15px; font-size: 0.7rem; width: 140px; display: none; border: 2px solid var(--pink); }

        .letter-tile { width: 60px; height: 60px; background: white; border-radius: 15px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; font-weight: bold; color: var(--pink); box-shadow: 0 4px 10px rgba(0,0,0,0.1); touch-action: none; }
    </style>
</head>
<body>

    <audio id="bg-music" loop src="Yellow.mp3"></audio>

    <div id="p1" class="container active-page">
        <div>
            <h1>Happy Birthday, Kuk! üéÇ</h1>
            <p class="subtitle">An interactive orange adventure!</p>
        </div>
        <img src="https://img.icons8.com/bubbles/200/birthday-cake.png" width="150">
        <button class="btn" onclick="nextPage(2)">START QUEST üçä</button>
    </div>

    <div id="p2" class="container">
        <h1>Step 1: Fresh Juice</h1>
        <p class="subtitle">HOLD the orange to fill the glass!</p>
        <div class="game-box">
            <div id="glass"><div id="juice"></div></div>
            <div id="orange-btn" style="font-size: 4rem; margin-left: 20px; cursor: pointer; user-select: none;" onmousedown="startSqueeze()" ontouchstart="startSqueeze()" onmouseup="stopSqueeze()" ontouchend="stopSqueeze()">üçä</div>
        </div>
        <p id="juice-status">0% Full</p>
    </div>

    <div id="p3" class="container">
        <h1>Step 2: Hide & Seek</h1>
        <p class="subtitle">Find the hidden Dino in the dark!</p>
        <div class="game-box" id="search-area" onmousemove="moveLight(event)" ontouchmove="moveLight(event)">
            <div id="dark-overlay"></div>
            <div id="flashlight"></div>
            <div id="hidden-dino" style="position:absolute; cursor:pointer; font-size: 3rem; z-index: 4;" onclick="nextPage(4)">ü¶ñ</div>
        </div>
    </div>

    <div id="p4" class="container">
        <h1>Step 3: The Maze</h1>
        <p class="subtitle">Drag the heart to the Dino!</p>
        <div class="game-box" id="maze-container">
            <div class="maze-wall" style="width: 80%; height: 10px; top: 60px; left: 0;"></div>
            <div class="maze-wall" style="width: 80%; height: 10px; bottom: 80px; right: 0;"></div>
            <div id="maze-target">ü¶ñ</div>
            <div id="maze-player">‚ù§Ô∏è</div>
        </div>
    </div>

    <div id="p5" class="container">
        <h1>Step 4: Orange Pops</h1>
        <p class="subtitle">Pop all the bubbles to clear the way!</p>
        <div class="game-box" id="bubble-box" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; padding: 20px;">
            </div>
    </div>

    <div id="p6" class="container">
        <h1>Step 5: Unlock the Name</h1>
        <p class="subtitle">Drag letters into order!</p>
        <div class="game-box" style="flex-direction: column; gap: 20px;">
            <div style="display: flex; gap: 10px;" id="drop-zone">
                <div class="letter-tile" style="border: 2px dashed #aaa; background: transparent;"></div>
                <div class="letter-tile" style="border: 2px dashed #aaa; background: transparent;"></div>
                <div class="letter-tile" style="border: 2px dashed #aaa; background: transparent;"></div>
            </div>
            <div style="display: flex; gap: 15px;" id="letter-dock">
                <div class="letter-tile" id="l1">U</div>
                <div class="letter-tile" id="l2">K</div>
                <div class="letter-tile" id="l3">K</div>
            </div>
        </div>
    </div>

    <div id="p7" class="container">
        <h1>Happy Birthday! üå∏</h1>
        <div style="overflow-y: auto; font-size: 0.9rem; color: #444; padding: 10px;">
            You made it! You are the superstar of the day. üåü <br><br>
            Kuk, you are genuinely one of the most amazing people I know. I hope your day is as bright as an orange and as sweet as a birthday cake. <br><br>
            Keep being your wonderful self!
        </div>
        <button class="btn" onclick="location.reload()">Replay? ü¶ñ</button>
    </div>

    <div id="mascot-container">
        <div id="speech"></div>
        <img id="mascot" src="dino.jpg">
    </div>

    <script>
        let juiceLevel = 0;
        let squeezeInterval;
        let bubblesPopped = 0;

        function nextPage(n) {
            if(n === 2) { 
                document.getElementById('bg-music').play();
                document.getElementById('mascot-container').style.display = 'block';
                showMascot("Let's go, Kuk!");
            }
            document.querySelectorAll('.container').forEach(c => c.classList.remove('active-page'));
            document.getElementById('p'+n).classList.add('active-page');
            
            if(n === 3) initSearch();
            if(n === 4) initMaze();
            if(n === 5) initBubbles();
            if(n === 6) initScramble();
        }

        function showMascot(text) {
            const s = document.getElementById('speech');
            s.innerText = text;
            s.style.display = 'block';
            setTimeout(() => s.style.display = 'none', 3000);
        }

        // GAME 1: Squeeze Logic
        function startSqueeze() {
            squeezeInterval = setInterval(() => {
                if(juiceLevel < 100) {
                    juiceLevel += 2;
                    document.getElementById('juice').style.height = juiceLevel + '%';
                    document.getElementById('juice-status').innerText = juiceLevel + '% Full';
                    gsap.to("#orange-btn", {scale: 0.9, duration: 0.1});
                } else {
                    stopSqueeze();
                    nextPage(3);
                }
            }, 50);
        }
        function stopSqueeze() {
            clearInterval(squeezeInterval);
            gsap.to("#orange-btn", {scale: 1, duration: 0.1});
        }

        // GAME 2: Flashlight Logic
        function initSearch() {
            const dino = document.getElementById('hidden-dino');
            dino.style.left = Math.random() * 70 + '%';
            dino.style.top = Math.random() * 70 + '%';
        }
        function moveLight(e) {
            const rect = document.getElementById('search-area').getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - rect.left;
            const y = (e.clientY || e.touches[0].clientY) - rect.top;
            gsap.to("#flashlight", {left: x - 60, top: y - 60, duration: 0.1});
        }

        // GAME 3: Maze Logic
        function initMaze() {
            Draggable.create("#maze-player", {
                type: "x,y",
                bounds: "#maze-container",
                onDrag: function() {
                    if (this.hitTest("#maze-target", "50%")) {
                        this.disable();
                        nextPage(5);
                    }
                }
            });
        }

        // GAME 4: Bubble Pop
        function initBubbles() {
            const box = document.getElementById('bubble-box');
            box.innerHTML = '';
            for(let i=0; i<12; i++) {
                const b = document.createElement('div');
                b.style.width = '50px'; b.style.height = '50px';
                b.style.background = 'orange'; b.style.borderRadius = '50%';
                b.style.cursor = 'pointer';
                b.onclick = function() {
                    gsap.to(this, {scale: 0, opacity: 0, duration: 0.2});
                    bubblesPopped++;
                    if(bubblesPopped === 12) nextPage(6);
                };
                box.appendChild(b);
            }
        }

        // GAME 5: Scramble Logic
        function initScramble() {
            Draggable.create(".letter-tile", {
                bounds: "body",
                onRelease: function() {
                    // Simplified: check if they are moved from bottom to top
                    if(this.y < -100) {
                        gsap.to(this.target, {opacity: 0.5});
                        // check logic for Kuk spelling
                        if(document.querySelectorAll('.letter-tile[style*="opacity: 0.5"]').length === 3) {
                            setTimeout(() => nextPage(7), 500);
                        }
                    }
                }
            });
        }
    </script>
</body>
</html>
